====================================================================
                    Buff系统统一重构总结
====================================================================

【重构目标】
统一项目中的 Buff 系统架构，采用"IStatusEffect 生命周期管理 + StatModifier 数值修改"的组合模式。

【架构决策】
✅ 保留 IStatusEffect / StatusEffectInstanceBase / StatusEffectComponent 作为生命周期管理层
✅ 强制所有数值型 Buff 使用 StatModifier 实现
✅ 非数值效果（控制、Hook）仍然使用接口式实现
✅ 统一命名规范：Definition 以 Definition 结尾，Instance 以 Instance 结尾

【完成的工作】
-----------

一、核心系统增强
1. CharacterStats.cs
   - ✅ 在 TakeDamage 中集成 StatusEffectComponent.ModifyIncomingDamage
   - ✅ 确保伤害减免 Buff 能正确生效

2. TargetTeam 枚举
   - ✅ 添加 Self 选项，支持"只对自己应用 Buff"的场景

二、创建完整的 Buff 示例（共7个）
1. ✅ MoveSpeedBuff（移动速度增益）
   - 数值型，使用 StatModifier.PercentAdd
   
2. ✅ AttackPowerBuff（攻击力增益）
   - 数值型，使用 StatModifier.Flat
   
3. ✅ SlowDebuff（减速减益）
   - 数值型，使用 StatModifier.PercentAdd（负数）
   
4. ✅ ShieldBuff（护盾效果）
   - 数值型，临时增加护甲
   
5. ✅ StunEffect（眩晕效果）
   - 控制型，直接设置 StatusEffectComponent.IsStunned
   
6. ✅ BurnEffect（灼烧效果，已优化）
   - 持续伤害型，OnTick 中造成伤害
   
7. ✅ DamageReductionBuff（伤害减免）
   - Hook 型，重写 ModifyIncomingDamage

三、创建完整的技能执行器示例（共6个）
1. ✅ BuffExecutor
   - 通用 Buff 应用执行器，支持自动检测目标/使用传入目标
   
2. ✅ DamageExecutor
   - 伤害执行器，支持固定伤害 + 基于攻击力的伤害
   
3. ✅ HealExecutor
   - 治疗执行器，支持固定治疗 + 基于最大生命值百分比
   
4. ✅ AreaEffectExecutor（已存在，保持不变）
   - 范围效果执行器
   
5. ✅ InstantBuffExecutor（已存在，保持不变）
   - 即时 Buff 应用
   
6. ✅ CompositeExecutor
   - 复合执行器，可组合多个执行器实现复杂技能

四、规范化现有代码
1. ✅ BurnEffectDefinition / BurnEffectInstance
   - 添加 namespace
   - 添加详细注释
   - 统一命名风格（_def 私有字段）
   - 添加空值检查

五、文档
1. ✅ BUFF_SYSTEM_GUIDE.txt
   - 详细的系统架构说明
   - 效果分类指南
   - 创建新 Buff 的步骤
   - 现有示例说明
   - 注意事项

2. ✅ BUFF_SYSTEM_REFACTOR_SUMMARY.txt（本文件）
   - 重构总结与变更清单

【新增文件清单】
--------------
Effect/EffectDefinition/
  - MoveSpeedBuffDefinition.cs
  - AttackPowerBuffDefinition.cs
  - SlowDebuffDefinition.cs
  - ShieldBuffDefinition.cs
  - StunEffectDefinition.cs
  - DamageReductionBuffDefinition.cs

Effect/Instance/
  - MoveSpeedBuffInstance.cs
  - AttackPowerBuffInstance.cs
  - SlowDebuffInstance.cs
  - ShieldBuffInstance.cs
  - StunEffectInstance.cs
  - DamageReductionBuffInstance.cs

SkillSystem/Executors/
  - BuffExecutor.cs
  - DamageExecutor.cs
  - HealExecutor.cs
  - CompositeExecutor.cs

Documentation/
  - BUFF_SYSTEM_GUIDE.txt
  - BUFF_SYSTEM_REFACTOR_SUMMARY.txt

【修改的文件清单】
----------------
- CharacterStats.cs
  - 在 TakeDamage 中添加 ModifyIncomingDamage 调用

- CardSystem/SkillSystem/Enum/Enum.cs
  - 给 TargetTeam 添加 Self 选项

- BurnEffectDefinition.cs
  - 添加 namespace、优化注释、统一命名

- BurnEffectInstance.cs
  - 添加 namespace、优化注释、添加空值检查

【使用示例】
----------

// 在 Unity 中创建一个移动速度增益 Buff
1. 右键 -> Create -> Character/Effects/Move Speed Buff
2. 配置：
   - effectId: "move_speed_buff_20"
   - duration: 5f
   - isStackable: false
   - speedModifierValue: 0.2f (20% 增益)
   - modifierType: PercentAdd

// 在技能中使用
1. 创建 SkillDefinition
2. executor 选择 BuffExecutor
3. 配置 BuffExecutor：targetTeam = Self
4. 在 Effects 列表中添加上面创建的 Buff

// 在代码中动态应用
var buffDef = Resources.Load<MoveSpeedBuffDefinition>("Path/To/Buff");
var buffInstance = buffDef.CreateInstance();
statusEffectComponent.AddEffect(buffInstance);

【下一步建议】
------------
1. 在 Unity 中为每个 Buff Definition 创建对应的 ScriptableObject 资源
2. 创建几个示例技能，验证执行器的功能
3. 如有其他老旧的 Buff 实现，逐步迁移到新架构
4. 根据实际需求添加更多 Buff 类型（如：反伤、吸血、免疫等）

【兼容性说明】
------------
✅ 现有代码完全兼容，没有破坏性修改
✅ 所有新增代码都有完整的命名空间，不会冲突
✅ 旧的 BurnEffect 已升级，保持向后兼容

====================================================================
